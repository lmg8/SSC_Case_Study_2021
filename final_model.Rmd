---
title: "Final Graph Models"
author: "Lucia Guintu"
date: "5/20/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
#install.packages("shinySIR")
#install.packages("devtools")
#library("devtools")

#install_github("SineadMorris/shinySIR")
```

```{r}
#library(shinySIR)
#run_shiny(model = "SIR")
```
```{r}
library(tidyverse)
library(deSolve)
library(lubridate)
library(ggforce)
library(ggrepel)
library(sysfonts)
library(showtext)
font_add("minion", regular = "Minion Pro Regular.ttf",
         bold = "Minion Pro Bold.ttf", italic = "Minion Pro Cond Italic.otf")

myFont<-"minion"
showtext_auto() ## automatically use showtext for new devices
```

```{r}
data<-read.csv("covidtesting.csv")
Infected<-subset(data,Reported.Date>=ymd("2020-12-25") & Reported.Date<=ymd("2021-04-02"))$Confirmed.Positive
Hospital<-subset(data,Reported.Date>=ymd("2020-12-25") & Reported.Date<=ymd("2021-04-02"))$Number.of.patients.hospitalized.with.COVID.19
Fatal<-subset(data,Reported.Date>=ymd("2020-12-25") & Reported.Date<=ymd("2021-04-02"))$Deaths

```
```{r}
vax_data<-read.csv("vaccine_doses (2).csv")
Vaccinated<-subset(vax_data,report_date>=ymd("2020-12-26") & report_date<=ymd("2021-04-03"))$total_individuals_fully_vaccinated
```






```{r}
# N = Total population
#S = Susceptible, E = Exposed, I = Infectious, H = Hospitalized, R = Recovered, Fa = Fatal, V = Vaccinated

#v = vaccination rate, ev = vaccine efficacy rate, im  - 1/(time it takes to lose immunity), beta - transmission rate, l  - 1/(latency for the onset of symptoms),
#rh  - Recovery rate of hospitalized individuals, ro - Rate of recovery for infected people who just recovered on their own, 
#h  - Rate of hospitalization (probability of hospitalization * 1/num days hospitalized)
#dl  - Rate of death occurred in LTC (death per day in LTC/total infectious population + death per day in LT),
#dh  - Rate of death occurred in hospitals (assumptions made) average(death per day in hospitals/total hospitalized population+death per day in hospitals)

SEIR1 <- function(time, current_state, params){

  with(as.list(c(current_state, params)),{
    v = ifelse(
        (time <= 12),
        0, 0.000130
        )
    N <- S+E+I+H+R+Fa+V
    dS <- -(beta*S*I)/N + im*R - (v*ev*S)
    dE <- (beta*S*I)/N - l*E
    dI <- l*E - ro*I - h*I - dl*I
    dH <- h*I - rh*H - dh*H
    dR <- ro*I + rh*H - im*R
    dFa <- dl*I + dh*H
    dV <- (v*ev*S)

    return(list(c(dS, dE, dI, dH, dR, dFa,dV)))
  })
}


params <- c(ev=0.942, im=1/140, beta=1.07/4.5, l=1/5.5, rh=1/15, ro=1/14, h=0.074*(1/14), dl=0.00291, dh=0.015)

initial_state <- c(S=13794672, E=12024, I=6666,  H=998,R=105512,Fa=4321,V=0)

times <- 0:98


model <- ode(initial_state, times, SEIR1, params)
summary(model)
out.df<-as.data.frame(model)

# add a Date column and the observed incidence,fatal,hospital, and vaccinated data
out.df <- out.df %>%
  mutate(
    Date = ymd("2020-12-26") + days(times),
    IEH=I+E+H,
  )


 # out.df <- out.df %>%
 #  mutate(
 #    percent_vaccinated=V/13924193
 #  )
```

```{r}

infect<-data %>% 
  filter(Reported.Date>= ymd("2020-12-01")) %>% 
  filter(Reported.Date <= ymd("2021-04-03"))
vax<-vax_data %>% 
  filter(report_date>= ymd("2020-12-01")) %>% 
  filter(report_date <= ymd("2021-04-03"))

library(grid)
library(gridExtra)
p<-ggplot() +
  geom_line(data=out.df,aes(x=Date,y=I + E + H,color="Model")) +
  geom_point(aes(x=ymd(Reported.Date),y=Confirmed.Positive,color="Actual data"), data=infect,size=0.5) +
  geom_vline(aes(xintercept = ymd("2020-12-26"),color="Lockdown starts (2020-12-26)"),show.legend = F,linetype="twodash") +
  geom_vline(aes(xintercept = ymd("2021-01-25"),color="Lockdown ends (2021-01-25)"),show.legend = F,linetype="twodash") +
  scale_y_continuous(labels = scales::comma,trans="log10") +
  scale_colour_manual("",breaks=c("Actual data","Model","Lockdown starts (2020-12-26)","Lockdown ends (2021-01-25)"),
values=c("#E31837","#E31837","#F17E68","#797a7c"),
guide = guide_legend(nrow=2,override.aes = list(
                         linetype = c(0,1,6,6), shape=c(20,NA,NA,NA)))) +
  labs(title="",y="Confirmed positive cases (log scale)") +
  theme_minimal()+
  theme(plot.title = element_text(hjust = 0.5),text=element_text(family=myFont,size=40),legend.position="bottom")


p2<-ggplot() +
  geom_line(data=out.df,aes(x=Date,y= H,color="Model")) +
  geom_point(aes(x=ymd(Reported.Date),y=Number.of.patients.hospitalized.with.COVID.19,color="Actual data"), data=infect,size=0.5) +
  geom_vline(aes(xintercept = ymd("2020-12-26")),color="#F17E68",linetype="twodash") +
  geom_vline(aes(xintercept = ymd("2021-01-25")),color = "#797a7c",linetype="twodash") +
  scale_y_continuous(labels = scales::comma,trans="log10") +
  scale_colour_manual("",breaks=c("Actual data","Model"),
values=c("#8E4465","#8E4465"),
guide = guide_legend(override.aes = list(
                         linetype = c(0,1), shape=c(20,NA)))) +
  labs(title="",y="Number of people hospitalized (log scale)") +
  theme_minimal()+
  theme(plot.title = element_text(hjust = 0.5),text=element_text(family=myFont,size=40),legend.position="bottom")

#legend.position="bottom"

p3<-ggplot() +
  geom_line(data=out.df,aes(x=Date,y=Fa,color="Model")) +
  geom_point(aes(x=ymd(Reported.Date),y=Deaths,color="Actual data"), data=infect,size=0.5) +
  geom_vline(aes(xintercept = ymd("2020-12-26")),color="#F17E68",linetype="twodash") +
  geom_vline(aes(xintercept = ymd("2021-01-25")),color = "#797a7c",linetype="twodash") +
  scale_y_continuous(labels = scales::comma,trans="log10") +
  scale_colour_manual(" ",breaks=c("Actual data","Model"),
values=c("#004658","#004658"),
guide = guide_legend(override.aes = list(
                         linetype = c(0,1), shape=c(20,NA)))) +
  labs(title="",y="Total deaths (log scale)") +
  theme_minimal()+
  theme(plot.title = element_text(hjust = 0.5),text=element_text(family=myFont,size=40),legend.position="bottom")

ggsave("plot1.png",plot=grid.arrange(p, p2, p3, ncol=3, top = textGrob("No lockdown 1",just = c("centre","top"),gp=gpar(fontsize=50,fontfamily=myFont,fontface="bold"))),width=13,height=5,dpi=300,limitsize = F)
```

```{r}

full1<-ggplot(data=out.df, aes(x=Date)) +
   geom_line(aes(y = S, color = "Susceptible")) +
   geom_line(aes(y = E, colour = "Exposed")) +
   geom_line(aes(y = I, colour = "Infectious")) +
   geom_line(aes(y = H, colour = "Hospitalized")) +
   geom_line(aes(y = R, colour = "Recovered")) + 
   geom_line(aes(y = Fa, colour = "Fatal")) +
   geom_line(aes(y = V, colour = "Vaccinated")) +
  theme_minimal() +
  scale_y_continuous(labels = scales::comma) +
  scale_colour_manual("Compartments",
breaks=c("Susceptible","Exposed","Infectious","Hospitalized","Recovered","Fatal","Vaccinated"),
values=c("#FFc31f","#F17E68","#E31837","#8E4465","#008BB0","#004658","#797A7C")) +
  labs(y="Number of people", x="Date", title = "SEIHRFV Model (No lockdown 1)") +
  theme(plot.title = element_text(hjust = 0.5,face="bold"),text=element_text(family="minion",size=80))

ggsave("full_model_1.png",plot=full1,width=11,height=7.25,dpi=300,limitsize = F)
```




```{r}

# Infected2<-subset(data,Reported.Date>=ymd("2021-04-02") & Reported.Date<=ymd("2021-05-20"))$Confirmed.Positive
# Hospital2<-subset(data,Reported.Date>=ymd("2021-04-02") & Reported.Date<=ymd("2021-05-20"))$Number.of.patients.hospitalized.with.COVID.19
# Fatal2<-subset(data,Reported.Date>=ymd("2021-04-02") & Reported.Date<=ymd("2021-05-20"))$Deaths
# 
# Vaccinated2<-subset(vax_data,report_date>=ymd("2021-04-02") & report_date<=ymd("2021-05-20"))$total_individuals_fully_vaccinated
```


```{r}
#Second lockdown

SEIR <- function(time, current_state, params){

  with(as.list(c(current_state, params)),{
    N <- S+E+I+H+R+Fa+V
    dS <- -(beta*S*I)/N + im*R - (v*ev*S)
    dE <- (beta*S*I)/N - l*E
    dI <- l*E - ro*I - h*I - dl*I
    dH <- h*I - rh*H - dh*H
    dR <- ro*I + rh*H - im*R
    dFa <- dl*I + dh*H
    dV <- (v*ev*S)

    return(list(c(dS, dE, dI, dH, dR, dFa,dV)))
  })
}


params <- c(v= 0.000244, ev=0.942, im=1/140, beta=1.14/4.5,  l=1/5.5, rh=1/15, ro=1/14, h=0.074*(1/14), dh=0.0156, dl=0.000236 )

initial_state <- c(S=13349992, E=13023, I=7831,  H=1162,R=224423,Fa=7412,V=320350)

times <- 0:153


model2 <- ode(initial_state, times, SEIR, params)
summary(model2)
out2<-as.data.frame(model2)

# add a Date column and the observed incidence data

library(lubridate)

out2 <- out2 %>%
  mutate(
    Date = ymd("2021-04-03") + days(times),
    IEH=I+E+H
    # actual_infected=Infected2,
    # actual_fatal=Fatal2,
    # actual_hospital=Hospital2,
    # actual_vaccinated=Vaccinated2
  )

```



```{r}

full2<-ggplot(data=out2, aes(x=Date)) +
   geom_line(aes(y = S, color = "Susceptible")) +
   geom_line(aes(y = E, colour = "Exposed")) +
   geom_line(aes(y = I, colour = "Infectious")) +
   geom_line(aes(y = H, colour = "Hospitalized")) +
   geom_line(aes(y = R, colour = "Recovered")) + 
   geom_line(aes(y = Fa, colour = "Fatal")) +
   geom_line(aes(y = V, colour = "Vaccinated")) +
  theme_minimal() +
  scale_y_continuous(labels = scales::comma) +
  scale_colour_manual("Compartments",
breaks=c("Susceptible","Exposed","Infectious","Hospitalized","Recovered","Fatal","Vaccinated"),
values=c("#FFc31f","#F17E68","#E31837","#8E4465","#008BB0","#004658","#797A7C")) +
  labs(y="Number of people", x="Date", title = "SEIHRFV Model (No lockdown 2)") +
  theme(plot.title = element_text(hjust = 0.5,face="bold"),text=element_text(family="minion",size=80))
ggsave("full_model_2.png",plot=full2,width=11,height=7.25,dpi=300,limitsize = F)
```



```{r}
infect<-data %>% 
  filter(Reported.Date>= ymd("2021-03-20")) %>% 
  filter(Reported.Date <= ymd("2021-09-03"))
vax<-vax_data %>% 
  filter(report_date>= ymd("2021-03-20")) %>% 
  filter(report_date <= ymd("2021-09-03"))


g<-ggplot() +
  geom_line(data=out2,aes(x=Date,y=I + E + H,color="Model")) +
  geom_point(aes(x=ymd(Reported.Date),y=Confirmed.Positive,color="Actual data"), data=infect,size=0.5) +
    geom_vline(aes(xintercept = ymd("2021-04-03"),color="Lockdown starts (2021-04-03)"),show.legend = F,linetype="twodash") +
  geom_vline(aes(xintercept = ymd("2021-05-29"),color="Lockdown ends (2021-05-29)"),show.legend = F,linetype="twodash") +
  scale_y_continuous(labels = scales::comma,trans="log10") +
scale_colour_manual("",breaks=c("Actual data","Model","Lockdown starts (2021-04-03)","Lockdown ends (2021-05-29)"),
values=c("#E31837","#E31837","#F17E68","#797a7c"),
guide = guide_legend(nrow=2,override.aes = list(
                         linetype = c(0,1,6,6), shape=c(20,NA,NA,NA)))) +
  labs(title="",y="Confirmed positive cases (log scale)") +
  theme_minimal()+
  theme(plot.title = element_text(hjust = 0.5),text=element_text(family=myFont,size=40),legend.position="bottom")


g2<-ggplot() +
  geom_line(data=out2,aes(x=Date,y= H,color="Model")) +
  geom_point(aes(x=ymd(Reported.Date),y=Number.of.patients.hospitalized.with.COVID.19,color="Actual data"), data=infect,size=0.5) +
  geom_vline(aes(xintercept = ymd("2021-04-03")),color="#F17E68",linetype="twodash") +
  geom_vline(aes(xintercept = ymd("2021-05-29")),color = "#797a7c",linetype="twodash") +
  scale_y_continuous(labels = scales::comma,trans="log10") +
  scale_colour_manual("",breaks=c("Actual data","Model"),
values=c("#8E4465","#8E4465"),
guide = guide_legend(override.aes = list(
                         linetype = c(0,1), shape=c(20,NA)))) +
  labs(title="",y="Number of people hospitalized (log scale)") +
  theme_minimal()+
  theme(plot.title = element_text(hjust = 0.5),text=element_text(family=myFont,size=40),legend.position="bottom")



g3<-ggplot() +
  geom_line(data=out2,aes(x=Date,y=Fa,color="Model")) +
  geom_point(aes(x=ymd(Reported.Date),y=Deaths,color="Actual data"), data=infect,size=0.5) +
  geom_vline(aes(xintercept = ymd("2021-04-03")),color="#F17E68",linetype="twodash") +
  geom_vline(aes(xintercept = ymd("2021-05-29")),color = "#797a7c",linetype="twodash") +
  scale_y_continuous(labels = scales::comma,trans="log10") +
  scale_colour_manual(" ",breaks=c("Actual data","Model"),
values=c("#004658","#004658"),
guide = guide_legend(override.aes = list(
                         linetype = c(0,1), shape=c(20,NA)))) +
  labs(title="",y="Total deaths (log scale)") +
  theme_minimal()+
  theme(plot.title = element_text(hjust = 0.5),text=element_text(family=myFont,size=40),legend.position="bottom")


ggsave("plot2.png",plot=grid.arrange(g, g2, g3, ncol=3, top = textGrob("No lockdown 2",just = c("centre","top"),gp=gpar(fontsize=50,fontfamily=myFont,fontface="bold"))),width=13,height=5,dpi=300,limitsize = F)
```


```{r}

Vaccinated<- vax_data %>% 
  subset(report_date>=ymd("2021-01-01") & report_date<=ymd("2021-05-29")) %>% 
  mutate(
    actual_vaccinated=total_individuals_fully_vaccinated/13924193
  )

params <- c(v=0.00268, ev=1, im=1/140, beta=0.836/4.5, l=1/5.5, rh=1/15, ro=1/14, h=0.074*(1/14), dl=8.38e-05, dh=0.0147
)

initial_state <- c(S=12973414, E=6273, I=7216,  H=934,R=268490,Fa=8726,V=659139)

times <- 0:4000


model <- ode(initial_state, times, SEIR, params)
summary(model)
out.df1<-as.data.frame(model)

# add a Date column and the observed incidence,fatal,hospital, and vaccinated data


 out.df1 <- out.df1 %>%
  mutate(
    Reported.Date = ymd("2021-05-30") + days(times),
    percent_vaccinated=V/13924193,
    percent_death=Fa/13924193
  )
```

```{r}
params <- c(v=0.00131, ev=1, im=1/140, beta=0.836/4.5, l=1/5.5, rh=1/15, ro=1/14, h=0.074*(1/14), dl=8.38e-05, dh=0.0147
)

initial_state <- c(S = 12973414, E = 6273, I = 7216, H = 934, R = 268490, Fa = 8726, V = 659139)

times <- 0:4000


model <- ode(initial_state, times, SEIR, params)
summary(model)
out.df2<-as.data.frame(model)

# add a Date column and the observed incidence,fatal,hospital, and vaccinated data


 out.df2 <- out.df2 %>%
  mutate(
    Reported.Date = ymd("2021-05-30") + days(times),
    percent_vaccinated=V/13924193,
    percent_death=Fa/13924193
  )
```

```{r}
params <- c(v=0.000347, ev=1, im=1/140, beta=0.836/4.5, l=1/5.5, rh=1/15, ro=1/14, h=0.074*(1/14), dl=8.38e-05, dh=0.0147
)

initial_state <- c(S = 12973414, E = 6273, I = 7216, H = 934, R = 268490, Fa = 8726, V = 659139)

times <- 0:4000


model <- ode(initial_state, times, SEIR, params)
summary(model)
out.df3<-as.data.frame(model)

# add a Date column and the observed incidence,fatal,hospital, and vaccinated data


 out.df3 <- out.df3 %>%
  mutate(
    Reported.Date = ymd("2021-05-30") + days(times),
    percent_vaccinated=V/13924193,
    percent_death=Fa/13924193
  )
```


```{r}

v_zoom<-ggplot(data=out.df1) +
   geom_line(aes(x=Reported.Date,y = percent_vaccinated, colour = "Vaccination rate (2021-05-29)")) +
    

  geom_line(data=out.df2,aes(x=Reported.Date,y = percent_vaccinated, colour = "Vaccination rate (Last 14 days)")) +
     #geom_line(aes(y = percent_death, colour = "Deaths")) +
  geom_line(data=out.df3,aes(x=Reported.Date,y = percent_vaccinated, colour = "Vaccination rate (All Time Average)")) +

  geom_point(aes(x=ymd(report_date),y=actual_vaccinated,color="Actual data"),data=Vaccinated,size=0.1)+
  
  geom_hline(yintercept=0.2,linetype="dashed") +
  geom_hline(yintercept=0.25,linetype="dashed") +
  geom_hline(yintercept=.60,linetype="dashed") +
  geom_vline(aes(xintercept = ymd("2021-05-29")),color="black",linetype="twodash") +
    
  #facet_zoom(ylim=c(0.00,0.4),xlim = c(ymd("2021-01-01"), ymd("2022-06-01")),horizontal=FALSE,zoom.size=1) +

geom_point(data = filter(out.df1, Reported.Date == "2021-08-06"),aes(x=Reported.Date,y=percent_vaccinated),color="#004658")+
geom_label_repel(data = filter(out.df1, Reported.Date == "2021-08-06"),aes(x=Reported.Date,y=percent_vaccinated,label="2021-08-06",family=myFont),color="#004658",
                 nudge_x = -20,nudge_y = 0.03,
                  arrow = arrow(length = unit(0.02, "npc")),
                     size= 15)+
geom_point(data = filter(out.df1, Reported.Date == "2021-09-02"),aes(x=Reported.Date,y=percent_vaccinated),color="#004658")+
geom_label_repel(data = filter(out.df1, Reported.Date == "2021-09-02"),aes(x=Reported.Date,y=percent_vaccinated,label="2021-09-02",family=myFont),color="#004658",
                 nudge_y = 0.06,
                  arrow = arrow(length = unit(0.02, "npc")),
                     size= 15)+
  geom_point(data = filter(out.df2, Reported.Date == "2021-12-03"),aes(x=Reported.Date,y=percent_vaccinated),color="#8e4465")+
geom_label_repel(data = filter(out.df2, Reported.Date == "2021-12-03"),aes(x=Reported.Date,y=percent_vaccinated,label="2021-12-03",family=myFont),color="#8e4465",
                 nudge_y = 0.03,
                  arrow = arrow(length = unit(0.02, "npc")),
                     size= 15)+
  annotate("text",label = "Present", x= ymd("2021-05-29"),y = 0.35,angle=90, vjust = -1,family=myFont,size=15,color="black")+

  scale_y_continuous(limits=c(0.00,0.4),breaks=c(0,0.1,0.2,0.25,0.3,0.4))+
  scale_x_date(limits=c(ymd("2021-01-01"), ymd("2022-06-01")))+
  theme_minimal()+
  scale_colour_manual("",
    breaks=c("Actual data","Vaccination rate (2021-05-29)","Vaccination rate (Last 14 days)","Vaccination rate (All Time Average)"),
values=c("black","#004658","#8e4465","#f17e68"),
guide = guide_legend(override.aes = list(
                         linetype = c("blank", "solid","solid","solid"), shape=c(20,NA,NA,NA)))) +
  labs(y="Percent of the population vaccinated", x="Date") +
theme(plot.title = element_text(hjust = 0.5),text=element_text(family=myFont,size=50),
      panel.border = element_rect(colour = "#ffe498",fill=NA, size=1))
ggsave("vax_zoomed.png",plot=v_zoom,width=11,height=5,dpi=300,limitsize = F)
```


```{r}
v<-ggplot(data=out.df1) +
   geom_line(aes(x=Reported.Date,y = percent_vaccinated, colour = "Vaccination rate (2021-05-29)")) +
    

  geom_line(data=out.df2,aes(x=Reported.Date,y = percent_vaccinated, colour = "Vaccination rate (Last 14 days)")) +
     #geom_line(aes(y = percent_death, colour = "Deaths")) +
  geom_line(data=out.df3,aes(x=Reported.Date,y = percent_vaccinated, colour = "Vaccination rate (All Time Average)")) +

  geom_point(aes(x=ymd(report_date),y=actual_vaccinated,color="Actual data"),data=Vaccinated,size=0.25)+
  
  geom_hline(yintercept=0.2,linetype="dashed") +
  geom_hline(yintercept=0.25,linetype="dashed") +
  geom_hline(yintercept=.60,linetype="dashed",color="#E31837") +
   
  geom_vline(aes(xintercept = ymd("2021-05-29")),color="black",linetype="twodash") +
    
  #facet_zoom(ylim=c(0.00,0.4),xlim = c(ymd("2021-01-01"), ymd("2022-06-01")),horizontal=FALSE,zoom.size=1) +

geom_point(data = filter(out.df1, Reported.Date == "2022-09-23"),aes(x=Reported.Date,y=percent_vaccinated),color="#004658")+
geom_label_repel(data = filter(out.df1, Reported.Date == "2022-09-23"),aes(x=Reported.Date,y=percent_vaccinated,label="2022-09-23",family=myFont),color="#004658",
                 nudge_x = -100,nudge_y = 0.2,
                  arrow = arrow(length = unit(0.02, "npc")),
                     size= 15)+
geom_point(data = filter(out.df2, Reported.Date == "2024-02-19"),aes(x=Reported.Date,y=percent_vaccinated),color="#8e4465")+
geom_label_repel(data = filter(out.df2, Reported.Date == "2024-02-19"),aes(x=Reported.Date,y=percent_vaccinated,label="2024-02-19",family=myFont),color="#8e4465",
                 nudge_y = -0.1,nudge_x = 200,
                  arrow = arrow(length = unit(0.02, "npc")),
                     size= 15)+
  geom_point(data = filter(out.df3, Reported.Date == "2032-02-04"),aes(x=Reported.Date,y=percent_vaccinated),color="#f17e68")+
geom_label_repel(data = filter(out.df3, Reported.Date == "2032-02-04"),aes(x=Reported.Date,y=percent_vaccinated,label="2032-02-04",family=myFont),color="#f17e68",
                 nudge_y = 0.1,
                  arrow = arrow(length = unit(0.02, "npc")),
                     size= 15)+
annotate("text",label = "Present", x= ymd("2021-05-29"),y = 0.8,angle=90, vjust = -1,family=myFont,size=15,color="black")+
annotate("text",label = "Herd immunity", x= ymd("2027-05-29"),y = 0.62,vjust=-0.1,family=myFont,size=15,color="#E31837")+
  scale_y_continuous(breaks=c(0,0.1,0.2,0.25,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1))+
  theme_minimal()+
  scale_colour_manual("",
    breaks=c("Actual data","Vaccination rate (2021-05-29)","Vaccination rate (Last 14 days)","Vaccination rate (All Time Average)"),
values=c("black","#004658","#8e4465","#f17e68"),
guide = guide_legend(override.aes = list(
                         linetype = c("blank", "solid","solid","solid"), shape=c(20,NA,NA,NA)))) +
  labs(y="Percent of the population vaccinated", x="Date") +
theme(plot.title = element_text(hjust = 0.5),text=element_text(family=myFont,size=50)) +
  annotate("rect", xmin=ymd("2021-01-01"), xmax=ymd("2022-06-01"), ymin=-0.03 , ymax=0.43, alpha=0.1, color="#ffe498", fill="#ffe498")
ggsave("vax.png",plot=v,width=11,height=5,dpi=300,limitsize = F)

  
```

